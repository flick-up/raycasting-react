(this.webpackJsonpraycasting=this.webpackJsonpraycasting||[]).push([[0],{13:function(t,e,n){t.exports=n(26)},25:function(t,e,n){},26:function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),a=n(6),o=n.n(a),c=n(1);function s(t,e){this.x=t,this.y=e}function h(t){this.height=t,this.size=10,this.grid=[[1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,1,1,1,1,0,1],[1,0,0,0,0,0,0,1,0,1],[1,0,0,0,0,1,0,1,0,1],[1,0,0,0,0,1,1,1,0,1],[1,0,1,0,0,0,0,0,0,1],[1,0,1,1,0,0,0,0,0,1],[1,0,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1]]}function u(t,e){return new s(Math.floor(t.x/e),Math.floor(t.y/e))}s.prototype.add=function(t,e){return new s(this.x+t,this.y+e)},s.prototype.distance=function(t){return Math.hypot(this.x-t.x,this.y-t.y)},h.prototype.isWall=function(t){var e=u(t,this.height);return this.isWithinCoordinateBounds(t)&&1===this.grid[e.y][e.x]},h.prototype.isWithinCoordinateBounds=function(t){var e=u(t,this.height);return e.x>=0&&e.x<this.size&&e.y>=0&&e.y<this.size};var l=n(7),d=n(8),f=n(12),p=n(11),y=2*Math.PI;function g(t){return t*Math.PI/180}var m=function(t){Object(f.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(l.a)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).wallsRef=r.a.createRef(),t.playerRef=r.a.createRef(),t.raysRef=r.a.createRef(),t}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.drawWalls(),this.drawPlayer(),this.drawRays()}},{key:"drawWalls",value:function(){var t=this.wallsRef.current.getContext("2d"),e=this.props,n=e.map,i=e.size/n.size;t.fillStyle="#212121",n.grid.forEach((function(e,n){e.forEach((function(e,r){1===e&&t.fillRect(r*i,n*i,i,i)}))}))}},{key:"drawPlayer",value:function(){var t=this.playerRef.current.getContext("2d"),e=this.props,n=e.map,i=e.player,r=e.size,a=i.position,o=a.x/n.height,c=a.y/n.height,s=r/n.size,h=o*s,u=c*s;t.clearRect(0,0,r,r),t.fillStyle="black",t.beginPath(),t.arc(h,u,5,0,y),t.fill()}},{key:"drawRays",value:function(){var t=this.raysRef.current.getContext("2d"),e=this.props,n=e.map,i=e.rays,r=e.size,a=r/n.size;t.clearRect(0,0,r,r),t.beginPath(),t.strokeStyle="#424242";for(var o=0;o<i.length;o+=16){var c=i[o],s=c.angle,h=c.distance,u=c.origin,l=u.x/n.height,d=u.y/n.height,f=h/n.height,p=l*a,y=d*a,g=r/n.size*f;t.moveTo(p,y),t.lineTo(p+g*Math.cos(s),y+g*-Math.sin(s)),t.stroke()}}},{key:"componentDidUpdate",value:function(t){t.rays!==this.props.rays&&(this.drawPlayer(),this.drawRays())}},{key:"render",value:function(){var t=this.props.size;return r.a.createElement("div",{style:v.container},r.a.createElement("canvas",{ref:this.wallsRef,height:t,width:t,style:v.layer}),r.a.createElement("canvas",{ref:this.playerRef,height:t,width:t,style:v.layer}),r.a.createElement("canvas",{ref:this.raysRef,height:t,width:t,style:v.layer}))}}]),n}(r.a.Component),v={container:{position:"absolute",top:"35%",left:"40px"},layer:{position:"absolute",boxShadow:"0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.3)",top:0,left:0}};function b(t,e,n){this.origin=n,this.angle=function(t){var e=t%y;return e<0?e+y:e}(e),this.distance=function(t,e,n){var i=e>0&&e<Math.PI,r=e<.25*y||e>.75*y,a=function(t,e,n,i,r){var a=Math.floor(e.y/t.height)*t.height+(i?-.01:t.height),o=new s(e.x+(e.y-a)/Math.tan(n),a),c=i?-t.height:t.height,h=Math.abs(t.height/Math.tan(n))*(r?1:-1);return w(t,o,h,c).distance(e)}(t,n,e,i,r),o=function(t,e,n,i,r){var a=Math.floor(e.x/t.height)*t.height+(r?t.height:-.01),o=e.y+(e.x-a)*Math.tan(n),c=new s(a,o),h=r?t.height:-t.height,u=Math.abs(t.height*Math.tan(n))*(i?-1:1);return w(t,c,h,u).distance(e)}(t,n,e,i,r);return Math.min(a,o)}(t,this.angle,n)}function w(t,e,n,i){return t.isWithinCoordinateBounds(e)?t.isWall(e)?e:w(t,e.add(n,i),n,i):new s(1/0,1/0)}function x(t,e,n){this.position=new s(t,e),this.direction=n}function R(t,e,n){return t.isWall(e)?0:n}x.prototype.castRays=function(t,e,n){var i=this,r=e/n,a=this.direction+e/2;return new Array(n).fill(0).map((function(t,e){return a-e*r})).map((function(e){return new b(t,e,i.position)}))},x.prototype.turnRight=function(t){this.direction-=.025*t/16},x.prototype.turnLeft=function(t){this.direction+=.025*t/16},x.prototype.moveForward=function(t,e){var n=e/16*1.4*Math.cos(this.direction),i=e/16*1.4*Math.sin(this.direction);this.position=this.position.add(R(t,this.position.add(n,0),n),R(t,this.position.add(0,-i),-i))},x.prototype.moveBackward=function(t,e){var n=e/16*1.4*Math.cos(this.direction),i=e/16*1.4*Math.sin(this.direction);this.position=this.position.add(R(t,this.position.add(-n,0),-n),R(t,this.position.add(0,i),i))},x.prototype.moveLeft=function(t,e){var n=e/16*1.4*Math.cos(this.direction+Math.PI/2),i=e/16*1.4*Math.sin(this.direction+Math.PI/2);this.position=this.position.add(R(t,this.position.add(n,0),n),R(t,this.position.add(0,-i),-i))},x.prototype.moveRight=function(t,e){var n=e/16*1.4*Math.cos(this.direction+Math.PI/2),i=e/16*1.4*Math.sin(this.direction+Math.PI/2);this.position=this.position.add(R(t,this.position.add(-n,0),-n),R(t,this.position.add(0,i),i))};var M=n(2),j=n(9),E=n.n(j);function O(t){var e=t.color,n=t.distance,i=t.mapHeight,a=t.number,o=t.resolution,c=t.screenHeight,s=t.screenWidth,h=Math.min(i/n*255,c),u=s/o,l=(c-h)/2,d={backgroundColor:E()(e).darken(n/460).hex(),height:h,left:a*u,width:u,position:"absolute",top:l};return r.a.createElement("div",{style:d})}function k(t){var e=t.height,n=t.mapHeight,a=t.player,o=t.rays,c=t.resolution,s=t.width,h=Object(i.useMemo)((function(){return Object(M.a)(Object(M.a)({},z.container),{},{height:e,width:s})}),[e,s]);return r.a.createElement("div",{style:h},r.a.createElement("div",{style:z.ceiling}),r.a.createElement("div",{style:z.floor}),o.map((function(t,i){return r.a.createElement(O,{color:"#424242",distance:C(t,a),key:i,mapHeight:n,number:i,resolution:c,screenHeight:e,screenWidth:s})})))}function C(t,e){return t.distance*Math.cos(t.angle-e.direction)}var z={container:{border:"1.15px solid rgb(45,45,45)",borderRadius:"6px",boxShadow:"0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.3)",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},ceiling:{backgroundColor:"#e3f2fd",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit",position:"absolute",left:0,right:0,bottom:"50%",top:0},floor:{backgroundColor:"#607d8b",borderBottomLeftRadius:"inherit",borderBottomRightRadius:"inherit",position:"absolute",left:0,right:0,bottom:0,top:"50%"}},P=n(3),W=n(10),L=n.n(W);function I(t,e){switch(e.type){case"down":return Object(M.a)(Object(M.a)({},t),{},Object(P.a)({},e.key,!0));case"up":return Object(M.a)(Object(M.a)({},t),{},Object(P.a)({},e.key,!1));default:return t}}function S(t,e){var n=e.andThen,r=void 0===n?function(){}:n,a=function(t,e){var n=Object(i.useReducer)(t,e),r=Object(c.a)(n,2),a=r[0],o=r[1],s=Object(i.useRef)(a);return Object(i.useEffect)((function(){s.current=a}),[a]),[s,o]}(I,{}),o=Object(c.a)(a,2),s=o[0],h=o[1];!function(t){var e=Object(i.useRef)(),n=Object(i.useRef)();Object(i.useEffect)((function(){n.current=window.performance.now()}),[]),Object(i.useEffect)((function(){return e.current=requestAnimationFrame((function i(r){e.current=requestAnimationFrame(i),t(r-n.current),n.current=r})),function(){return cancelAnimationFrame(e.current)}}),[t])}(Object(i.useCallback)((function(e){var n=!1;L()(t,(function(t,i){s.current[i]&&(n=!0,t(e))})),n&&r()}),[s,t,r])),Object(i.useEffect)((function(){var e=Object.keys(t);function n(t){e.includes(t.code)&&(t.preventDefault(),h({type:"down",key:t.code}))}function i(t){e.includes(t.code)&&(t.preventDefault(),h({type:"up",key:t.code}))}return document.addEventListener("keydown",n),document.addEventListener("keyup",i),function(){document.removeEventListener("keydown",n),document.removeEventListener("keyup",i)}}),[t,h])}var A=g(60),B=new h(64),D=new x(160,160,g(0));var T={container:{display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"50px"}};n(25);o.a.render(r.a.createElement((function(){var t=Object(i.useState)(!0),e=Object(c.a)(t,2),n=e[0],a=e[1],o=function(t,e,n,r){var a=Object(i.useState)([]),o=Object(c.a)(a,2),s=o[0],h=o[1],u=Object(i.useCallback)((function(){var i=t.castRays(e,n,r);h(i)}),[t,e,n,r]);return Object(i.useEffect)((function(){u()}),[u]),S(Object(i.useMemo)((function(){return{KeyW:function(n){t.moveForward(e,n)},KeyS:function(n){t.moveBackward(e,n)},KeyA:function(n){t.moveLeft(e,n)},KeyD:function(n){t.moveRight(e,n)},ArrowLeft:function(e){t.turnLeft(e)},ArrowRight:function(e){t.turnRight(e)}}}),[t,e]),{andThen:u}),s}(D,B,A,320);return r.a.createElement("div",{style:T.container},r.a.createElement("h3",null,"Raycasting React Experiment"),r.a.createElement("div",null,r.a.createElement(k,{height:480,mapHeight:B.height,player:D,rays:o,resolution:320,width:840}),r.a.createElement("div",null,r.a.createElement("span",null,"Move your player using the W, A, S, D, \u2190, and \u2192 Keys!"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"show_minimap"},"Show minimap",r.a.createElement("input",{id:"show_minimap",onChange:function(){return a(!n)},type:"checkbox",checked:n}))))),n&&r.a.createElement(m,{fov:A,map:B,player:D,rays:o,resolution:320,size:250}))})),document.getElementById("application-root"))}},[[13,1,2]]]);
//# sourceMappingURL=main.6f21f74f.chunk.js.map